# Lolicon 插件

调用 Lolicon API v2 发送随机二次元图片的 QQ 机器人插件。

## 功能特性

- 🖼️ 调用 Lolicon API v2 获取高质量二次元图片
- 💾 本地缓存功能，减少重复下载
- 🔒 R18 内容权限控制，仅限私聊或管理员使用
- 🏷️ 支持标签搜索
- 📊 缓存状态管理
- ⚡ 批量发送和转发消息支持

## 安装依赖

```bash
pip install aiohttp>=3.8.0
```

## 配置说明

插件支持以下配置项：

- `cache_expire`: 缓存过期时间(秒)，默认 86400 (24小时)
- `batch`: 一批发送的图片数量，默认 5
- `lim_f`: 不使用转发的阈值，默认 3
- `lim_u`: 普通用户一次请求最大发送数量，默认 10
- `lim_a`: 超级用户一次请求最大发送数量，默认 30
- `enable_r18`: 是否启用 R18 内容，默认 False
- `r18_private_only`: R18 内容是否仅限私聊，默认 True

### 启用 R18 功能

要启用 R18 功能，可以通过以下方式：
#### 通过QQ消息配置

管理员可以直接在QQ中发送以下命令：

```
/enable_r18                    # 启用R18功能
/disable_r18                   # 禁用R18功能
/set_r18_private true          # 设置R18仅限私聊使用
/set_r18_private false         # 允许R18在群聊中使用（仅限管理员）
```

2. **重启机器人**使配置生效

**注意**：启用 R18 功能后，请确保遵守相关法律法规，仅在合适的场合使用。

## 使用命令

### 用户命令

- `/loli [数量] [标签]` - 发送随机二次元图片
  - 示例：`/loli`、`/loli 3`、`/loli 5 萝莉`、`/loli 萝莉 白丝`、`/loli 萝莉 白丝`

- `/r18 [数量] [标签]` - 发送 R18 二次元图片(需要权限)
  - 示例：`/r18`、`/r18 3`、`/r18 5 萝莉`、`/r18 萝莉 白丝`
  - 需要启用 R18 功能且有相应权限

**参数说明**：
- 如果第一个参数是数字，则作为数量，后面的参数作为标签
- 如果第一个参数不是数字，则所有参数都作为标签，数量默认为1
- 标签使用AND规则，最多支持3个标签
- 示例：`/loli 萝莉 白丝` = 1张同时包含"萝莉"和"白丝"标签的图片

### 管理员命令

- `/status` - 查看插件状态
- `/cache_status` - 查看缓存状态
- `/clear_cache` - 清理图片缓存
- `/enable_r18` - 启用R18功能
- `/disable_r18` - 禁用R18功能
- `/set_r18_private [true/false]` - 设置R18是否仅限私聊

### 使用限制

- 普通用户一次最多可请求 10 张图片
- 超级用户一次最多可请求 30 张图片
- 超过 3 张图片会使用合并转发消息发送

## 缓存机制

- 图片会自动缓存到 `plugins/Lolicon/cache/` 目录
- 缓存索引保存在 `cache_index.json` 文件中
- 支持缓存过期时间配置
- 提供缓存清理和状态查看功能

## API 说明

本插件调用 [Lolicon API v2](https://docs.api.lolicon.app/#/setu) 接口：

- 接口地址：`https://api.lolicon.app/setu/v2`
- 返回格式：JSON

## 注意事项

1. 请合理使用 API，避免频繁请求
2. R18 内容请遵守相关法律法规
3. 建议定期清理缓存以节省存储空间
4. 图片版权归原作者所有，请尊重版权 